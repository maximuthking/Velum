# 프로젝트: Velum (AI 개발용 기능 명세서)

## 1. 기본 설정 (Core Setup)

* **게임 장르:** 3D 힐링 어드벤처 / 소셜 멀티플레이어
* **그래픽 스타일:** 로우폴리 (Low-Poly)
* **카메라: `고정된 탑뷰 시점 (Fixed Top-Down View)`**
    * **기본:** 카메라는 항상 플레이어의 배를 위에서 내려다보는 각도를 유지하며 따라다님.
    * **조작:**
        * **마우스 이동:** 카메라 시점 회전 기능 없음.
        * **마우스 휠:** 카메라 줌 인/아웃.
* **플랫폼:** **웹 브라우저**

## 2. 플레이어 캐릭터: 배 (Player Ship)

* **조작 상세 (Control Details):**
    * **이동 (`W`, `S`) - 관성 적용:**
        * `W` 또는 `S` 키를 누르면 배가 즉시 최고 속도에 도달하지 않고, **서서히 가속**합니다.
        * 키에서 손을 떼면 관성에 의해 즉시 멈추지 않고, 물의 저항을 받으며 **부드럽게 미끄러지다 멈춥니다.**
        * `S` 키를 이용한 후진 가속도와 최고 속도는 전진의 50% 수준으로 설정합니다.
    * **방향 전환 (`A`, `D`) - 느린 제자리 회전:**
        * 배의 이동 여부와 관계없이 `A`, `D` 키로 방향을 전환할 수 있습니다.
        * 제자리에서 회전하는 속도는 **느리게 설정**하여, 묵직한 배가 방향을 트는 느낌을 줍니다.
* **핵심 속성: 내구도 (Durability)**
    * **표현 방식: `시각적 손상 표현 (Visual Damage Representation)`**
        * 게임 화면에 내구도 수치나 바(Bar) 같은 **UI를 전혀 표시하지 않습니다.**
        * 플레이어는 오직 **배의 외형 변화**를 통해서만 손상 정도를 파악합니다.
    * **손상 단계별 효과:**
        * **정상 (100% ~ 71%):** 배의 외형이 깨끗하고 성능이 정상.
        * **경미한 손상 (70% ~ 31%):**
            * **시각 효과:** 배 모델의 여러 군데에 **작은 금(crack) 텍스처**가 나타나고, 돛에 **작게 찢어진 구멍**이 생깁니다.
            * **성능 저하:** 최고 속도와 방향 전환 속도가 **10% 감소**.
        * **심각한 손상 (30% ~ 1%):**
            * **시각 효과:** 배의 금이 더 많고 깊어지며, 돛이 너덜너덜해집니다. 뱃머리에서 **검은 연기 파티클**이 계속 피어오릅니다.
            * **성능 저하:** 최고 속도와 방향 전환 속도가 **30% 감소**.
    * **손상 원인별 대미지:**
        * **암초 충돌:** 최대 내구도의 5% 고정 대미지.
        * **소용돌이:** 초당 최대 내구도의 1% 지속 대미지.
        * **플레이어 간 충돌:** 최대 내구도의 2% 고정 대미지.
    * **침몰 방지:** 어떤 경우에도 내구도는 1% 이하로 떨어지지 않음.
* **커스터마이징 (외형 꾸미기):**
    * 성능과 무관한 시각적 요소만 변경 가능.
    * 변경 가능 부위: 돛의 색상, 뱃머리 장식, 랜턴 등.
    * 꾸미기 아이템은 '낚시' 중 낮은 확률로 얻는 '보물상자'에서 획득.
* **플레이어 성장 (스킬 시스템):**
    * 특정 행동을 반복하면 관련 스킬 레벨이 오르는 패시브 스킬 시스템.
    * **항해 스킬:** 총 항해 거리에 비례하여 레벨 상승. 레벨 당 배의 **최고 속도**가 0.5%씩 영구적으로 증가.
    * **낚시 스킬:** 낚시 성공 횟수에 비례하여 레벨 상승. 레벨 당 **낚시 미니게임의 성공 구간**이 0.5%씩 넓어짐.
    * **수리 스킬:** 배 수리에 사용한 총 골드에 비례하여 레벨 상승. 레벨 당 **수리 비용**이 0.5%씩 영구적으로 할인됨.

## 3. 월드 (World)

* **동적 환경 시스템 (Dynamic Environment System):**
    * **시간의 흐름:**
        * 게임 내 시간은 현실 시간 기준 24분에 하루가 지나감 (낮 12분, 밤 12분).
        * 시간에 따라 해와 달이 움직이며 하늘의 색과 광원 효과가 부드럽게 변화함. 밤하늘에는 별과 은하수가 나타남.
    * **날씨 변화:**
        * **맑음:** 기본 상태. 특별한 효과 없음.
        * **비:** 시야가 약간 어두워지고 빗방울 파티클과 파문 효과가 나타남. 비 오는 날에만 등장하는 희귀 물고기가 있음.
        * **안개:** 시야 거리가 크게 감소하여 항해 난이도가 상승. 안개 속에서만 발견할 수 있는 비밀 장소가 있음.
* **지역별 생태계 (Biome Details):**
    * **1. 산호초 군도 (Coral Archipelago):**
        * **특징:** 에메랄드빛 얕은 바다와 하얀 모래섬. 수면 아래로 화려한 산호초가 비쳐 보임.
        * **고유 지형지물:** 거대한 거북 등껍질 모양의 섬, 반쯤 가라앉은 난파선.
        * **고유 위험요소:** 수면 바로 아래에 숨어있어 발견하기 어려운 **'얕은 산호초'**.
    * **2. 침엽수림 해안 (Coniferous Coast):**
        * **특징:** 깊고 어두운 색의 바다. 해안선은 깎아지른 절벽과 침엽수림으로 이루어져 있음.
        * **고유 지형지물:** 밤이 되면 빛을 밝히는 오래된 등대, 절벽에서 바다로 떨어지는 폭포.
        * **고유 위험요소:** 예측할 수 없는 위치에 갑자기 생성되는 **'짙은 안개 지대'**.
    * **3. 수정 동굴 (Crystal Caves):**
        * **특징:** 바다와 연결된 거대한 동굴 내부. 벽과 천장의 거대한 수정들이 스스로 빛을 발해 신비로운 분위기를 연출.
        * **고유 지형지물:** 동굴 중앙에서 맥박처럼 빛을 내는 거대 수정, 물속에서 빛나는 발광 식물 군락.
        * **고유 위험요소:** 천장에서 갑자기 떨어지는 **'종유석'**, 배가 겨우 지나갈 수 있는 **'좁은 수로'**.
* **상호작용 가능한 발견물 (Interactable Discoveries):**
    * **유리병 편지:** 바다 위에 무작위로 떠다니는 오브젝트. 획득 시, 이 세계의 숨겨진 이야기나 희귀 물고기 출현 조건에 대한 힌트를 얻을 수 있음.
    * **떠다니는 상자:** 나무로 된 작은 상자. 배로 부딪혀 부수면 소량의 골드나 일반 수리 재료를 획득.
    * **고래 떼:** 특정 시간, 특정 해역에서 출현하는 비상호작용 이벤트. 플레이어의 배 주변을 한동안 함께 유영하며 장관을 연출.
    * **간단한 배달 퀘스트:** 항구의 특정 NPC에게 말을 걸면, 다른 지역의 NPC에게 아이템을 전달해달라는 간단한 퀘스트를 받을 수 있음. 완료 시 골드와 꾸미기 아이템을 보상으로 받음.

## 4. 핵심 시스템 (Core Systems)

### 가. 낚시 시스템

* **역할:** 게임 내 재화(골드)를 버는 유일한 수단.
* **낚시 방식: `타이밍 미니게임`**
    1.  플레이어는 원하는 장소에 배를 멈춘다.
    2.  마우스 클릭으로 낚싯대를 던진다.
    3.  일정 시간 후 입질이 오면, 화면에 **움직이는 막대(Bar) UI**가 나타난다.
    4.  막대가 **'성공 구간'** 에 도달했을 때 정확히 클릭하면 낚시 성공.
    5.  성공 시 물고기 또는 보물상자를 획득. 실패 시 아무것도 얻지 못함.
* **수집 요소: 물고기 도감**
    * 잡은 물고기의 종류는 '도감' UI에 기록.
    * 도감에서 물고기의 3D 모델, 설명, 출현 지역/날씨/시간 정보를 확인 가능.
    * 물고기는 지역, 날씨, 시간에 따라 다른 종류가 등장.

### 나. 경제 및 수리 시스템

* **재화:** 골드 (Gold)
* **획득:** 항구의 '생선 가게' NPC에게 잡은 물고기를 팔아서 획득.
* **소비:** 항구의 '수리공' NPC에게 골드를 지불하고 배의 내구도를 수리.

### 다. 멀티플레이어 시스템

* **서버:** 모든 플레이어는 동일한 월드에서 실시간으로 만남.
* **상호작용:**
    * **충돌:** 플레이어 간 충돌이 가능하며, 양쪽 모두에게 가벼운 내구도 손상을 입힘.
    * **소통:** 텍스트 채팅은 없음. 대신, 특정 키를 눌러 배 위로 **이모티콘**을 띄우는 기능 제공. (예: 손 흔들기, 하트, 느낌표)
* **협동:**
    * **낚시 보너스:** 여러 플레이어가 가까운 거리에서 함께 낚시하면, 희귀 물고기 등장 확률이 모두에게 소폭 상승.

### 라. 사운드 시스템 (Sound System)

* **배경음악 (BGM):**
    * 지역(Biome)과 시간(낮/밤)에 따라 다른 음악이 재생되어 분위기를 조성.
    * 예: 산호초 군도(낮) - 경쾌한 우쿨렐레 / 침엽수림(밤) - 차분한 피아노.
* **환경음 (Ambient Sound):**
    * 게임의 몰입감을 높이기 위한 배경 소리.
    * 파도 소리, 갈매기 소리, 비 오는 소리, 동굴의 물방울 소리 등.
* **효과음 (SFX):**
    * 플레이어의 행동에 대한 즉각적인 피드백.
    * 낚싯대 던지는 소리, 낚시 성공/실패 소리, 배 충돌음, 버튼 클릭음 등.

## 5. 기술 스택 (Tech Stack)

### 가. 프론트엔드 (Client-Side)

* **UI 프레임워크:** **React**
* **핵심 언어:** **TypeScript** (with JSX)
* **3D 그래픽:** **@react-three/fiber** 및 **@react-three/drei**
* **상태 관리:** **Jotai**

### 나. 백엔드 (Server-Side)

* **런타임 환경:** **Node.js**
* **서버 프레임워크:** **Express.js**

### 다. 네트워킹 (Networking)

* **실시간 통신:** **Socket.IO**

## 6. 개발 시 주요 기술 과제 (Key Technical Challenges)

* **가. 멀티플레이어 동기화 (Multiplayer Synchronization):**
    * **과제:** 네트워크 지연(Latency)으로 인한 플레이어 간 위치 불일치 현상 해결.
    * **해결 방향:**
        * **서버 권위(Server-Authoritative):** 모든 상호작용의 최종 판정은 서버가 담당.
        * **클라이언트 측 보간/예측:** 다른 플레이어의 움직임을 부드럽게 표현하기 위한 기술 적용.
        * **입력 유효성 검사:** 서버에서 클라이언트의 비정상적인 입력(예: 속도 핵)을 검증하고 차단.
* **나. 성능 최적화 (Performance Optimization):**
    * **과제:** 다양한 사양의 PC 환경에서 부드러운 프레임 속도 유지.
    * **해결 방향:**
        * **에셋 관리:** 3D 모델의 폴리곤 수와 텍스처 해상도를 최적화하여 로딩 속도 및 렌더링 부하 감소.
        * **렌더링 최적화:** 시야각 컬링(Frustum Culling), 인스턴싱(Instancing) 등 기술을 활용하여 렌더링 효율 증대.
* **다. 서버 안정성 및 확장성 (Server Stability & Scalability):**
    * **과제:** 동시 접속자 수 증가에 따른 서버 과부하 방지.
    * **해결 방향:**
        * **확장 가능한 아키텍처:** 초기부터 채널링 또는 샤딩(Sharding)을 염두에 둔 서버 구조 설계.
        * **데이터베이스 최적화:** 효율적인 쿼리 작성 및 필요시 캐싱 전략 도입으로 DB 부하 관리.